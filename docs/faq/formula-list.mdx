---
id: formula-list
title: List of Formulas and Functions
---

import useBaseUrl from "@docusaurus/useBaseUrl"; // Add to the top of the file below the front matter.

ValQ supports many traditional user-friendly functions that allows you
to create complex models. You may recognize many of these from your
experience with Microsoft Excel.

## Logical Functions

<table>
  <thead>
    <tr>
      <th>
        <strong>NAME</strong>
      </th>
      <th>
        <strong>SYNTAX</strong>
      </th>
      <th>
        <strong>DESCRIPTION</strong>
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/if')}>IF</a>
      </td>
      <td>If( logical_test, value_if_true, value_if_false )</td>
      <td>
        Checks whether a condition is met, and returns one value if TRUE, and
        another value if FALSE
      </td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/switch')}>SWITCH</a>
      </td>
      <td>
        SWITCH ( expression, value1, result1, value2, result2, ... value_n,
        result_n [, default] )
      </td>
      <td>
        Evaluates an expression against a list of values and returns the result
        corresponding to the first matching value. If there is no match, an
        optional default value is returned.
      </td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/and')}>AND</a>
      </td>
      <td>AND( logical_test1, [logical_test2], ... )</td>
      <td>
        Checks whether all the arguments are TRUE, and returns TRUE if all
        arguments are TRUE
      </td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/or')}>OR</a>
      </td>
      <td>OR( logical_test1, [logical_test2], ... )</td>
      <td>
        Checks whether any of the arguments are TRUE, and returns TRUE or FALSE.
        Returns FALSE only if all arguments are FALSE
      </td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/not')}>NOT</a>
      </td>
      <td>NOT( logical_test )</td>
      <td>Changes FALSE to TRUE, or TRUE to FALSE</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/xor')}>XOR</a>
      </td>
      <td>XOR( logical_test1, [logical_test2], ... )</td>
      <td>Returns a logical &#39;Exclusive Or&#39; of all arguments</td>
    </tr>
  </tbody>
</table>

## Math Functions

<table>
  <thead>
    <tr>
      <th>
        <strong>NAME</strong>
      </th>
      <th>
        <strong>SYNTAX</strong>
      </th>
      <th>
        <strong>DESCRIPTION</strong>
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/sum')}>SUM</a>
      </td>
      <td>Sum(value1,[value2]....)</td>
      <td>
        Add all numbers in the arguments, which can be numbers or node
        references
      </td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/average')}>AVERAGE</a>
      </td>
      <td>Average(value1,[value2]....)</td>
      <td>
        Returns the average (arithmetic mean) of its arguments, which can be
        numbers or node references
      </td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/averageexzero')}>AVERAGEEXZERO</a>
      </td>
      <td>AverageExZero(value1,[value2]....)</td>
      <td>
        Returns the average (arithmetic mean) of its arguments excluding zeros,
        which can be numbers or node references
      </td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/averageexneg')}>AVERAGEEXNEG</a>
      </td>
      <td>AverageExNeg(value1,[value2]....)</td>
      <td>
        Returns the average (arithmetic mean) of its arguments excluding
        negatives, which can be numbers or node references
      </td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/averageexzeroneg')}>AVERAGEEXZERONEG</a>
      </td>
      <td>AverageExZeroNeg(value1,[value2]....)</td>
      <td>
        Returns the average (arithmetic mean) of its arguments excluding zeros
        and negatives, which can be numbers or node references
      </td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/count')}>COUNT</a>
      </td>
      <td>Count(value1,[value2]....)</td>
      <td>Counts the number of items in a range</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/abs')}>ABS</a>
      </td>
      <td>ABS(value)</td>
      <td>Returns the absolute value of a number, a number without its sign</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/min')}>MIN</a>
      </td>
      <td>Min(value1,[value2]....)</td>
      <td>
        Returns the smallest number in a set of values. Node references also
        accepted as arguments
      </td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/max')}>MAX</a>
      </td>
      <td>Max(value1,[value2]....)</td>
      <td>
        Returns the largest number in a set of values. Node references also
        accepted as arguments
      </td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/power')}>POWER</a>
      </td>
      <td>POW(value,power)</td>
      <td>Returns the result of a number raised to a power</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/sqrt')}>SQRT</a>
      </td>
      <td>SQRT(value)</td>
      <td>Returns the square root of a number</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/exp')}>EXP</a>
      </td>
      <td>EXP(value)</td>
      <td>Returns e raised to the power of a given number</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/log')}>LOG</a>
      </td>
      <td>LOG(value,base)</td>
      <td>Returns the logarithm of a number to the base you specify</td>
    </tr>
  </tbody>
</table>

## Finance Functions

<table>
  <thead>
    <tr>
      <th>
        <strong>NAME</strong>
      </th>
      <th>
        <strong>SYNTAX</strong>
      </th>
      <th>
        <strong>DESCRIPTION</strong>
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/irr')}>IRR</a>
      </td>
      <td>IRR (Values, [Guess])</td>
      <td>
        Returns the internal rate of return for a series of cash flows. Node
        references also accepted as arguments
      </td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/npv')}>NPV</a>
      </td>
      <td>NPV (Rate, value1, [value2], ...)</td>
      <td>
        Returns the net present value of an investment based on a discount rate
        and a series of future payments (negative values) and income (positive
        values)
      </td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/pmt')}>PMT</a>
      </td>
      <td>PMT(Rate, Nper, PV, [FV], [Type])</td>
      <td>
        Calculates the payment for a loan based on constant payments and a
        constant interest rate
      </td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/ipmt')}>IPMT</a>
      </td>
      <td>IPMT (Rate, Per, Nper, PV, [FV], [Type])</td>
      <td>
        Returns the interest payment for a given period for an investment,based
        on periodic, constant payments and a constant interest rate
      </td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/fv')}>FV</a>
      </td>
      <td>FV (Rate, Nper, [Pmt], PV, [Type])</td>
      <td>
        Returns the future value of an investment based on periodic, constant
        payments and a constant interest rate
      </td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/pv')}>PV</a>
      </td>
      <td>PV(Rate, Nper, [Pmt], FV, [Type])</td>
      <td>Returns the present value of an investment</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/cumipmt')}>CUMIPMT</a>
      </td>
      <td>CUMIPMT (Rate, Nper, PV, start_period, end_period, Type)</td>
      <td>Returns the cumulative interest paid between two periods</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/cmprinc')}>CMPRINC</a>
      </td>
      <td>CUMPRINC (Rate, Nper, PV, start_period, end_period, Type)</td>
      <td>
        Returns the cumulative principal paid on a loan between two periods
      </td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/rate')}>RATE</a>
      </td>
      <td>RATE(Nper, PMT, PV, [FV], [Type], [Guess])</td>
      <td>Returns the interest rate per period of a loan or an investment.</td>
    </tr>
  </tbody>
</table> 

## Range Functions

<table>
  <thead>
    <tr>
      <th>
        <strong>NAME</strong>
      </th>
      <th>
        <strong>SYNTAX</strong>
      </th>
      <th>
        <strong>DESCRIPTION</strong>
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/range')}>Range</a>
      </td>
      <td>.Range(start_index,end_index)</td>
      <td></td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/lastnperiods')}>LastNPeriods</a>
      </td>
      <td>.LastNPeriods(n)</td>
      <td></td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/get')}>Get</a>
      </td>
      <td>.Get(period_index)</td>
      <td></td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/foreach')}>ForEach</a>
      </td>
      <td>ForEach(Array,Iterator)</td>
      <td>Iterator function</td>
    </tr>
  </tbody>
</table>

## Static Identifiers And Other Formats

<table>
  <thead>
    <tr>
      <th>
        <strong>CONSTANTS</strong>
      </th>
      <th>
        <strong>EXPLANATION</strong>
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/this')}>THIS</a>
      </td>
      <td>Current Node</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/me')}>ME</a>
      </td>
      <td>Current Node</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/current_series')}>CURRENT_SERIES</a>
      </td>
      <td>Current series label</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/current_series_id')}>
          CURRENT_SERIES_ID{" "}
        </a>
      </td>
      <td>Current series id</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/current_period_index')}>CURRENT_PERIOD_INDEX</a>
      </td>
      <td>Current period index</td>
    </tr>
        <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/sim_from_to_index')}>SIM_FROM_INDEX</a>
      </td>
      <td>Sim From period index</td>
    </tr>
        <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/sim_from_to_index')}>SIM_TO_INDEX</a>
      </td>
      <td>Sim To period index</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/node-properties')}>[NODE].PARENT</a>
      </td>
      <td>Parent Node</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/node-properties')}>[NODE].CHILDREN</a>
      </td>
      <td>Node children</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/node-properties')}>[NODE].act</a>
      </td>
      <td>Simulated Series of the node</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/node-properties')}>[NODE].tgt </a>
      </td>
      <td>Comparison Series of the node</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/node-properties')}>[NODE].base </a>
      </td>
      <td>Baseline Series of the node</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/node-properties')}>
          [NODE].ALL_PERIODS
        </a>
      </td>
      <td>Returns all Period values</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/node-properties')}>
          [NODE].SIM_PERIODS
        </a>
      </td>
      <td>Returns simulation period values</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/node-properties')}>
          [NODE].act.ALL_PERIODS
        </a>
      </td>
      <td>Returns all period values of Simulated Series,</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/node-properties')}>
          [NODE].tgt.ALL_PERIODS{" "}
        </a>
      </td>
      <td>Returns all period values of Comparison Series</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/node-properties')}>
          [NODE].base.ALL_PERIODS
        </a>
      </td>
      <td>Returns all period values of Baseline Series</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/node-properties')}>
          [NODE].act.SIM_PERIODS{" "}
        </a>
      </td>
      <td>Returns simulation period values of Simulated Series</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/node-properties')}>
          [NODE].tgt.SIM_PERIODS{" "}
        </a>
      </td>
      <td>Returns simulation period values of Comparison Series</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/node-properties')}>
          [NODE].base.SIM_PERIODS
        </a>
      </td>
      <td>Returns simulation period values of Baseline Series</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/node-properties')}>
          [NODE].Range(start_index,end_index)
        </a>
      </td>
      <td>Returns selected range values</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/node-properties')}>
          [NODE].act.Range(start_index,end_index)
        </a>
      </td>
      <td>Returns selected range values of Simulated Series</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/node-properties')}>
          [NODE].base.Range(start_index,end_index)
        </a>
      </td>
      <td>Returns selected range values of Baseline Series</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/node-properties')}>
          [NODE].tgt.Range(start_index,end_index)
        </a>
      </td>
      <td>Returns selected range values of Comparison Series</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/node-properties')}>
          [NODE].Get(period_index){" "}
        </a>
      </td>
      <td>Returns selected period value</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/node-properties')}>
          [NODE].act.Get(period_index)
        </a>
      </td>
      <td>Returns selected period value of Simulated Series</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/node-properties')}>
          [NODE].base.Get(period_index){" "}
        </a>
      </td>
      <td>Returns selected period value of Baseline Series</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/node-properties')}>
          [NODE].tgt.Get(period_index)
        </a>
      </td>
      <td>Returns selected period value of Comparison Series</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/node-properties')}>
          [NODE].LastNPeriods(n){" "}
        </a>
      </td>
      <td>Returns selected range values</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/node-properties')}>
          [NODE].act.LastNPeriods(n){" "}
        </a>
      </td>
      <td>Returns selected range values of Simulated Series</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/node-properties')}>
          [NODE].base.LastNPeriods(n){" "}
        </a>
      </td>
      <td>Returns selected range values of Baseline Series</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl('/docs/references/formulas/node-properties')}>
          [NODE].tgt.LastNPeriods(n){" "}
        </a>
      </td>
      <td>Returns selected range values of Comparison Series</td>
    </tr>
  </tbody>
</table>
